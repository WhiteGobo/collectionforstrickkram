import unittest
import importlib.resources
import os.path
import networkx as netx
import numpy as np
import tempfile

#from . import PlySurfaceHandler
from ..meshhandler import plysurfacehandler, relax_gridgraph
#from .new_gridrelaxator import relax_gridgraph
from . import test_src

from ..strickgraph import strickgraph_fromgrid as fromgrid
from ..strickgraph.load_stitchinfo import myasd as stinfo

class TestMeshhandlerMethods( unittest.TestCase ):
    def setUp( self ):
        self.testmeshfilename = "meshfortests.ply"
        pass

    def test_createsurfacemap( self ):
        with importlib.resources.path( test_src, "tester.ply" ) as filepath:
            #q = PlySurfaceHandler.plysurfacehandler.load_from_file( filepath )
            q = plysurfacehandler.load_from_file( filepath )
        #mysurfacemap = surfacemap.from_surface( mysurface )
        #surfmap = q.create_surfacemap( 0 )
        q.complete_surfaces_with_map()
        mysurfacemap = q.get_surface( 0 ).get_surfacemap()
        #mysurfacemap.visualize_with_matplotlib()

        with tempfile.TemporaryDirectory() as tmpdir:
            myfilepath = os.path.join( tmpdir, "surfmap.ply" )
            q.save_to_file( myfilepath )
            #mysurfacemap.to_plyfile( myfilepath )
            #copy_surfmap = surfacemap.from_plyfile( myfilepath )


    def test_wholerelaxing( self ):
        with importlib.resources.path( test_src, "surfmap.ply" ) as filepath:
            #q = PlySurfaceHandler.plysurfacehandler.load_from_file( filepath )
            q = plysurfacehandler.load_from_file( filepath )
        mysurfacemap = q.get_surface( 0 ).get_surfacemap()
        mygraph = netx.grid_2d_graph( 30, 30 )
        firstrow = [ x for x in mygraph.nodes() if x[0] == 0 ]
        gridgraph = fromgrid.create_strickgraph_from_gridgraph( mygraph, \
                                                        firstrow, \
                                                        stinfo )

        border = gridgraph.get_borders()
        positions = relax_gridgraph( gridgraph, mysurfacemap )
        netx.set_node_attributes( gridgraph, positions )

        if False:
            from ..visualizer import myvis3d
            myvis3d( gridgraph )

        xpos = netx.get_node_attributes( gridgraph, "x" )
        #ypos = netx.get_node_attributes( gridgraph, "y" )
        #zpos = netx.get_node_attributes( gridgraph, "z" )
        realnodes = list( gridgraph.give_real_graph().nodes() )
        testarray = [ test[node] for node in realnodes ]
        xposarray = [ xpos[node] for node in realnodes ]
        tmpbool = np.allclose( xposarray, testarray, atol=0.1 )
        self.assertTrue( tmpbool )
        return 

test = {(0, 0): -0.679672, (0, 1): -0.7024111379310345, (0, 2): -0.725150275862069, (0, 3): -0.7465759206896552, (0, 4): -0.767900527586207, (0, 5): -0.7850428448275861, (0, 6): -0.8014881137931035, (0, 7): -0.8155180862068966, (0, 8): -0.8288893413793104, (0, 9): -0.8403861482758621, (0, 10): -0.851133175862069, (0, 11): -0.8579188068965518, (0, 12): -0.8625036620689656, (0, 13): -0.8666069999999999, (0, 14): -0.8703492, (0, 15): -0.8703491999999999, (0, 16): -0.866607, (0, 17): -0.8625036620689654, (0, 18): -0.8579188068965518, (0, 19): -0.851133175862069, (0, 20): -0.8403861482758621, (0, 21): -0.8288893413793104, (0, 22): -0.8155180862068965, (0, 23): -0.8014881137931035, (0, 24): -0.7850428448275861, (0, 25): -0.767900527586207, (0, 26): -0.7465759206896552, (0, 27): -0.7251502758620689, (0, 28): -0.7024111379310345, (0, 29): -0.679672, (1, 0): -0.640849951724138, (1, 1): -0.6633073223546034, (1, 2): -0.6857005494122869, (1, 3): -0.7062754535062243, (1, 4): -0.7265575369909469, (1, 5): -0.744879350962797, (1, 6): -0.7627291153156115, (1, 7): -0.7766498711267484, (1, 8): -0.7894328904190506, (1, 9): -0.8010715044242539, (1, 10): -0.8121210750892693, (1, 11): -0.8191349490711152, (1, 12): -0.8238818580744085, (1, 13): -0.8280484346252533, (1, 14): -0.8317233344878956, (1, 15): -0.8317290485612466, (1, 16): -0.8280690761660152, (1, 17): -0.8238783734716267, (1, 18): -0.819058536022143, (1, 19): -0.8120248489965646, (1, 20): -0.8010631672425352, (1, 21): -0.7893779900715236, (1, 22): -0.7762006071488394, (1, 23): -0.7621328922848921, (1, 24): -0.7450623679344038, (1, 25): -0.727338350415812, (1, 26): -0.7066653020260942, (1, 27): -0.6857551535258923, (1, 28): -0.663326806949565, (1, 29): -0.640849951724138, (2, 0): -0.602027903448276, (2, 1): -0.6241791269935084, (2, 2): -0.6463245870843854, (2, 3): -0.6660585269509709, (2, 4): -0.6856518108216847, (2, 5): -0.704897312810054, (2, 6): -0.7241375271697107, (2, 7): -0.7379685263845375, (2, 8): -0.7502518409052209, (2, 9): -0.7620312737921181, (2, 10): -0.7735575060784777, (2, 11): -0.7807424689215336, (2, 12): -0.7854735702494733, (2, 13): -0.7897343247163062, (2, 14): -0.7936049587884979, (2, 15): -0.7936145580684156, (2, 16): -0.7897745629809847, (2, 17): -0.7854677082654242, (2, 18): -0.7805943611401913, (2, 19): -0.7733747259199837, (2, 20): -0.7620116833834651, (2, 21): -0.7501257446525664, (2, 22): -0.737064428755124, (2, 23): -0.7230125169256352, (2, 24): -0.7052864083231599, (2, 25): -0.6871856558956431, (2, 26): -0.66684303182731, (2, 27): -0.6464445325246727, (2, 28): -0.6242228468607234, (2, 29): -0.602027903448276, (3, 0): -0.5626654586206897, (3, 1): -0.5839809521695968, (3, 2): -0.6053509201829699, (3, 3): -0.6247579132140725, (3, 4): -0.6442816013880462, (3, 5): -0.661890434053327, (3, 6): -0.6793885340929127, (3, 7): -0.693051327673526, (3, 8): -0.7057992937083879, (3, 9): -0.7170555603690747, (3, 10): -0.7277950250126193, (3, 11): -0.7348189915728288, (3, 12): -0.7398675431042963, (3, 13): -0.744163327922516, (3, 14): -0.7479176800162961, (3, 15): -0.748054845713372, (3, 16): -0.7445826109949536, (3, 17): -0.7403675033320014, (3, 18): -0.7351352470599378, (3, 19): -0.728044064602392, (3, 20): -0.7174266799382298, (3, 21): -0.7061136460790435, (3, 22): -0.692890545186305, (3, 23): -0.6790564264542804, (3, 24): -0.6623787389029892, (3, 25): -0.6453496140411303, (3, 26): -0.6251860955935834, (3, 27): -0.6052164261917191, (3, 28): -0.5838924969414434, (3, 29): -0.5626654586206897, (4, 0): -0.5232614448275863, (4, 1): -0.5433104822236245, (4, 2): -0.5639009103699716, (4, 3): -0.5830177530917073, (4, 4): -0.6025094499178807, (4, 5): -0.6183662601428025, (4, 6): -0.6339463269107866, (4, 7): -0.6474643778441781, (4, 8): -0.6606832517478314, (4, 9): -0.6714310413627675, (4, 10): -0.681318181256487, (4, 11): -0.6881925232763272, (4, 12): -0.6935405648906044, (4, 13): -0.6978900833798269, (4, 14): -0.7015285311229693, (4, 15): -0.7018031921565562, (4, 16): -0.6987127838152192, (4, 17): -0.6945873093782571, (4, 18): -0.6890365633940142, (4, 19): -0.6820668073877594, (4, 20): -0.6722326099424463, (4, 21): -0.661470008869501, (4, 22): -0.6481097943575544, (4, 23): -0.6344972061963156, (4, 24): -0.618954618777324, (4, 25): -0.6030472124197304, (4, 26): -0.5830617562610212, (4, 27): -0.5635132338391665, (4, 28): -0.5430891686933539, (4, 29): -0.5232614448275863, (5, 0): -0.4783797620689655, (5, 1): -0.49798421374197527, (5, 2): -0.5180208979100998, (5, 3): -0.5357922204348543, (5, 4): -0.5539829508215993, (5, 5): -0.5687849109318083, (5, 6): -0.583471254795624, (5, 7): -0.5965259524434494, (5, 8): -0.6095296560390902, (5, 9): -0.6194782042554706, (5, 10): -0.6284392872825801, (5, 11): -0.6349537850931447, (5, 12): -0.6403275513487539, (5, 13): -0.6444741626981115, (5, 14): -0.6477674256535834, (5, 15): -0.6479511163235542, (5, 16): -0.6450314991181203, (5, 17): -0.6410591614379954, (5, 18): -0.6355950829464143, (5, 19): -0.6290119849587555, (5, 20): -0.6200151943732694, (5, 21): -0.610022908126204, (5, 22): -0.5970090877689217, (5, 23): -0.5839267159165514, (5, 24): -0.569146224452654, (5, 25): -0.5542044563692035, (5, 26): -0.5356782431083245, (5, 27): -0.5176261295493947, (5, 28): -0.4977661912638861, (5, 29): -0.4783797620689655, (6, 0): -0.4325851344827586, (6, 1): -0.4514583423014943, (6, 2): -0.4708725615201868, (6, 3): -0.48718875492031954, (6, 4): -0.5039223254623281, (6, 5): -0.5178022740051702, (6, 6): -0.5317379135514338, (6, 7): -0.5442953361221271, (6, 8): -0.556942792443597, (6, 9): -0.5661181806300806, (6, 10): -0.5741950658535069, (6, 11): -0.5803432630330209, (6, 12): -0.5856682578053083, (6, 13): -0.5895841638271399, (6, 14): -0.5925085300553322, (6, 15): -0.5925724732408062, (6, 16): -0.5897877518983469, (6, 17): -0.5859677735538495, (6, 18): -0.5806772593563376, (6, 19): -0.5744990643711343, (6, 20): -0.5663058731593245, (6, 21): -0.5570505316682458, (6, 22): -0.544479014045808, (6, 23): -0.5319457895279688, (6, 24): -0.5178870751702497, (6, 25): -0.5038664037083589, (6, 26): -0.4869450249346069, (6, 27): -0.47048447222800616, (6, 28): -0.4512521250444469, (6, 29): -0.4325851344827586, (7, 0): -0.38549110344827586, (7, 1): -0.4029219932260414, (7, 2): -0.42083088715052924, (7, 3): -0.43551396697660577, (7, 4): -0.4505896519370254, (7, 5): -0.4633891212576199, (7, 6): -0.47640704197266825, (7, 7): -0.4877649009809029, (7, 8): -0.4991770254974811, (7, 9): -0.5074027573290053, (7, 10): -0.5147308880651817, (7, 11): -0.5203674200022368, (7, 12): -0.5253520786807093, (7, 13): -0.5289034444479391, (7, 14): -0.5314595613217661, (7, 15): -0.5315032510765487, (7, 16): -0.5290431944637416, (7, 17): -0.5255760523934199, (7, 18): -0.5206526031652574, (7, 19): -0.51501313148823, (7, 20): -0.5075980411557576, (7, 21): -0.4993079349277435, (7, 22): -0.4879490896089969, (7, 23): -0.47660019819647437, (7, 24): -0.4634880211381492, (7, 25): -0.4505816069873547, (7, 26): -0.4353719181154213, (7, 27): -0.420590815948575, (7, 28): -0.40279568639400126, (7, 29): -0.38549110344827586, (8, 0): -0.33804268965517237, (8, 1): -0.3535026085020435, (8, 2): -0.3696080427629893, (8, 3): -0.38256056166770946, (8, 4): -0.3959386528440183, (8, 5): -0.4076058936064768, (8, 6): -0.419621528361798, (8, 7): -0.42967270011167796, (8, 8): -0.43969274586364615, (8, 9): -0.44698178381412745, (8, 10): -0.453584557653563, (8, 11): -0.45869343441809113, (8, 12): -0.4632653790886687, (8, 13): -0.4664495245738537, (8, 14): -0.46866447246922116, (8, 15): -0.46871302311951113, (8, 16): -0.4665976089787768, (8, 17): -0.4635020516007422, (8, 18): -0.4589924329199562, (8, 19): -0.45390349628339777, (8, 20): -0.4472659553987469, (8, 21): -0.4399439749712715, (8, 22): -0.4299343785985479, (8, 23): -0.4198675671784351, (8, 24): -0.40778860368075776, (8, 25): -0.39605032427637815, (8, 26): -0.3825597572851896, (8, 27): -0.36952300026143, (8, 28): -0.3534544955559975, (8, 29): -0.33804268965517237, (9, 0): -0.2882431034482758, (9, 1): -0.3016831637361965, (9, 2): -0.31567056842547625, (9, 3): -0.3270404366039387, (9, 4): -0.338809314696245, (9, 5): -0.3489977330535188, (9, 6): -0.35954473023257905, (9, 7): -0.3680809238326178, (9, 8): -0.37657166901071165, (9, 9): -0.38284835150472335, (9, 10): -0.3886723417953787, (9, 11): -0.39314211984497627, (9, 12): -0.3971580237168797, (9, 13): -0.3998852157523325, (9, 14): -0.4017221312302, (9, 15): -0.4017732005716837, (9, 16): -0.4000360034280978, (9, 17): -0.39740127797137176, (9, 18): -0.3934491017175051, (9, 19): -0.38901168666974884, (9, 20): -0.3831801671797377, (9, 21): -0.3768862951011185, (9, 22): -0.36838470261167905, (9, 23): -0.35982336068924253, (9, 24): -0.34922623828495225, (9, 25): -0.33898660579494455, (9, 26): -0.32711940800467654, (9, 27): -0.31566724221568554, (9, 28): -0.30167887899734436, (9, 29): -0.2882431034482758, (10, 0): -0.237503048275862, (10, 1): -0.2487365190084619, (10, 2): -0.26049304189967565, (10, 3): -0.27022334174122375, (10, 4): -0.2803651582518138, (10, 5): -0.288968640959489, (10, 6): -0.29786979674619707, (10, 7): -0.3048649421428723, (10, 8): -0.3118030499211366, (10, 9): -0.31706574654601416, (10, 10): -0.32207128055591866, (10, 11): -0.3258772996077939, (10, 12): -0.3292915482027635, (10, 13): -0.3315607061694579, (10, 14): -0.3330305240304543, (10, 15): -0.3330850846863335, (10, 16): -0.3317177754957595, (10, 17): -0.32954651120533107, (10, 18): -0.32619624760711075, (10, 19): -0.32243050540402496, (10, 20): -0.31743356599845773, (10, 21): -0.31215867943315434, (10, 22): -0.3051897595643084, (10, 23): -0.29816132176308574, (10, 24): -0.28921345233555085, (10, 25): -0.28057360937079523, (10, 26): -0.2703494909378831, (10, 27): -0.26054156123524863, (10, 28): -0.24876285435188866, (10, 29): -0.237503048275862, (11, 0): -0.18556102758620685, (11, 1): -0.19450290557817065, (11, 2): -0.20384655971605184, (11, 3): -0.21164371046286973, (11, 4): -0.21978748136831633, (11, 5): -0.22658232179427737, (11, 6): -0.23361706808793192, (11, 7): -0.23909758712695756, (11, 8): -0.24456261108620586, (11, 9): -0.24873839604655704, (11, 10): -0.25277111779736905, (11, 11): -0.255811605625616, (11, 12): -0.25854654718742637, (11, 13): -0.2603246770777979, (11, 14): -0.26144823851885746, (11, 15): -0.26150266713671805, (11, 16): -0.26048208376966575, (11, 17): -0.25879917188164225, (11, 18): -0.2561291816725571, (11, 19): -0.2531321989290423, (11, 20): -0.2491166067097951, (11, 21): -0.24495846001617164, (11, 22): -0.23953740154958025, (11, 23): -0.2340773922397145, (11, 24): -0.2269489893665235, (11, 25): -0.22007790317823078, (11, 26): -0.21181080739121894, (11, 27): -0.20389879588826088, (11, 28): -0.19453208326743132, (11, 29): -0.18556102758620685, (12, 0): -0.13295124827586202, (12, 1): -0.1395590094179907, (12, 2): -0.14643435900983998, (12, 3): -0.15210984423426602, (12, 4): -0.15804476185722474, (12, 5): -0.1629381426594998, (12, 6): -0.16800360838497658, (12, 7): -0.1719904109298825, (12, 8): -0.17599469932397083, (12, 9): -0.17905227178123545, (12, 10): -0.18202224868089545, (12, 11): -0.18425187701242635, (12, 12): -0.18626209233389907, (12, 13): -0.18755227910013061, (12, 14): -0.18835127427560916, (12, 15): -0.1884106995103301, (12, 16): -0.18772352073533988, (12, 17): -0.1865297161379314, (12, 18): -0.1845849248824526, (12, 19): -0.1823941253771547, (12, 20): -0.179439220181507, (12, 21): -0.17642760646346467, (12, 22): -0.17255376198190597, (12, 23): -0.1686493162737175, (12, 24): -0.1634412901344363, (12, 25): -0.15842101910000939, (12, 26): -0.15231268315897162, (12, 27): -0.14648185500675767, (12, 28): -0.1395847646871145, (12, 29): -0.13295124827586202, (13, 0): -0.07994773508306202, (13, 1): -0.08395216909901423, (13, 2): -0.08812513073677053, (13, 3): -0.09156904840933924, (13, 4): -0.09516958846020881, (13, 5): -0.0981128201808763, (13, 6): -0.10116750308239922, (13, 7): -0.10357881973570725, (13, 8): -0.10601264966139268, (13, 9): -0.10788038945753076, (13, 10): -0.10970997252468834, (13, 11): -0.11106810534793306, (13, 12): -0.11229819220011866, (13, 13): -0.11308622601436201, (13, 14): -0.11357624479866296, (13, 15): -0.11362988868568906, (13, 16): -0.11324118957378404, (13, 17): -0.11253945388332677, (13, 18): -0.11137297285019039, (13, 19): -0.11005675734101081, (13, 20): -0.10826418097904901, (13, 21): -0.10645046424461237, (13, 22): -0.10411610268265918, (13, 23): -0.10176251016345775, (13, 24): -0.09859160080601545, (13, 25): -0.0955354823288851, (13, 26): -0.09178884496434359, (13, 27): -0.08821563524178677, (13, 28): -0.08399700145761409, (13, 29): -0.07994773508306202, (14, 0): -0.026648921478420642, (14, 1): -0.028000896785146858, (14, 2): -0.029384984921165605, (14, 3): -0.030533871196967974, (14, 4): -0.031734590660770355, (14, 5): -0.03271030916499142, (14, 6): -0.033730451952640184, (14, 7): -0.03453097123411445, (14, 8): -0.03534352482923536, (14, 9): -0.03597682213043534, (14, 10): -0.036601843605917665, (14, 11): -0.0370634227681854, (14, 12): -0.03748511208037331, (14, 13): -0.03776598178579646, (14, 14): -0.03795746009233761, (14, 15): -0.038006113939853335, (14, 16): -0.037907220434108845, (14, 17): -0.03770634751659692, (14, 18): -0.037347171820081945, (14, 19): -0.036929495733791805, (14, 20): -0.036343967220580954, (14, 21): -0.03574427833593692, (14, 22): -0.03495862890685681, (14, 23): -0.03415654194123106, (14, 24): -0.033077513375694256, (14, 25): -0.03203162927415595, (14, 26): -0.030753581744783716, (14, 27): -0.02953282104146046, (14, 28): -0.028071843700381183, (14, 29): -0.026648921478420642, (15, 0): 0.026649875073303516, (15, 1): 0.02805343422987499, (15, 2): 0.029502029097118136, (15, 3): 0.030681504323048364, (15, 4): 0.031915662341447576, (15, 5): 0.032918627980484824, (15, 6): 0.03394883756238021, (15, 7): 0.03476320236177828, (15, 8): 0.035577925733403674, (15, 9): 0.036217508387622215, (15, 10): 0.036850076456184294, (15, 11): 0.037305226214499616, (15, 12): 0.03769511171409168, (15, 13): 0.03791685463313922, (15, 14): 0.03802565345753742, (15, 15): 0.03797191870828147, (15, 16): 0.037762529142479344, (15, 17): 0.037452282692450316, (15, 18): 0.03699934117611656, (15, 19): 0.03650940640906534, (15, 20): 0.0358777732120199, (15, 21): 0.03525077380998065, (15, 22): 0.034452968563924276, (15, 23): 0.03367873761122844, (15, 24): 0.032669354508102204, (15, 25): 0.03170230804370404, (15, 26): 0.030483289887605913, (15, 27): 0.02932716004418786, (15, 28): 0.0279675315063248, (15, 29): 0.026649875073303516, (16, 0): 0.07994865457211038, (16, 1): 0.08397571493148431, (16, 2): 0.08817329239113841, (16, 3): 0.0916829426211693, (16, 4): 0.09535392973262535, (16, 5): 0.09834140584816234, (16, 6): 0.10142922394955807, (16, 7): 0.10383016908779141, (16, 8): 0.10623086637498817, (16, 9): 0.10810039555858755, (16, 10): 0.10994192705411863, (16, 11): 0.11129068017977611, (16, 12): 0.1124875410197089, (16, 13): 0.11323812635534497, (16, 14): 0.1136910030989089, (16, 15): 0.1136421305688464, (16, 16): 0.11310033197116835, (16, 17): 0.11226437790019209, (16, 18): 0.11100784886506658, (16, 19): 0.10962373889566498, (16, 20): 0.10779764345825717, (16, 21): 0.10595522989139197, (16, 22): 0.10358524545644893, (16, 23): 0.10123695098094794, (16, 24): 0.0981600888736098, (16, 25): 0.0951990522612155, (16, 26): 0.09152917303936428, (16, 27): 0.08803744232688931, (16, 28): 0.0839024457531996, (16, 29): 0.07994865457211038, (17, 0): 0.13295218965517241, (17, 1): 0.13955727072792357, (17, 2): 0.14642259977501082, (17, 3): 0.15218401800407128, (17, 4): 0.1582078497920437, (17, 5): 0.1631705068731534, (17, 6): 0.16830683114000206, (17, 7): 0.17225640118777164, (17, 8): 0.17618771092016425, (17, 9): 0.17924023425439461, (17, 10): 0.18222512959297932, (17, 11): 0.18444166295658077, (17, 12): 0.18641896300595634, (17, 13): 0.1877116856007293, (17, 14): 0.18854685159600953, (17, 15): 0.18850453721040186, (17, 16): 0.18759672887323597, (17, 17): 0.18622772849918373, (17, 18): 0.18419783656639402, (17, 19): 0.18194742103451525, (17, 20): 0.17897286120391895, (17, 21): 0.17594233865733155, (17, 22): 0.17204568859801095, (17, 23): 0.16814615023525212, (17, 24): 0.16301453658991716, (17, 25): 0.15807185664167966, (17, 26): 0.15205394368611153, (17, 27): 0.1463200531425105, (17, 28): 0.13949553173084459, (17, 29): 0.13295218965517241, (18, 0): 0.1855620655172415, (18, 1): 0.19451421158215265, (18, 2): 0.20385765548003962, (18, 3): 0.21169568416230627, (18, 4): 0.21987136007737632, (18, 5): 0.2267622740405769, (18, 6): 0.2339167820542016, (18, 7): 0.23935763325455944, (18, 8): 0.24473703960757437, (18, 9): 0.24889887086497495, (18, 10): 0.2529336835974398, (18, 11): 0.25595323742846143, (18, 12): 0.2586518597380977, (18, 13): 0.2604750437629437, (18, 14): 0.26172065998397864, (18, 15): 0.2616835483713317, (18, 16): 0.2603741071118707, (18, 17): 0.25848781663289, (18, 18): 0.25574649994174814, (18, 19): 0.25269715762727246, (18, 20): 0.24865920228312366, (18, 21): 0.24450872894255068, (18, 22): 0.23917375111583422, (18, 23): 0.2337820850255967, (18, 24): 0.22661130894394976, (18, 25): 0.21971848106016242, (18, 26): 0.21152803475624654, (18, 27): 0.20370333523461154, (18, 28): 0.19442645937988873, (18, 29): 0.1855620655172415, (19, 0): 0.2375040793103449, (19, 1): 0.2487341544438404, (19, 2): 0.26047601303615925, (19, 3): 0.2702255146776134, (19, 4): 0.2803767694276118, (19, 5): 0.2890882111324361, (19, 6): 0.29812729663679394, (19, 7): 0.30508834959077435, (19, 8): 0.3119450471359861, (19, 9): 0.31718923686540423, (19, 10): 0.3221892565108843, (19, 11): 0.32597139381621354, (19, 12): 0.329351625456055, (19, 13): 0.33168526430801304, (19, 14): 0.3333113146303237, (19, 15): 0.33328087956007296, (19, 16): 0.33159936327037165, (19, 17): 0.3292160271344544, (19, 18): 0.32580186105370734, (19, 19): 0.3219903826246747, (19, 20): 0.3169715897870412, (19, 21): 0.311723821381658, (19, 22): 0.3049149135849369, (19, 23): 0.29799846183881007, (19, 24): 0.2889324244085901, (19, 25): 0.28021207305795515, (19, 26): 0.2700617429277361, (19, 27): 0.26033673846574024, (19, 28): 0.24865430970000363, (19, 29): 0.2375040793103449, (20, 0): 0.28824394137931053, (20, 1): 0.3015949692248742, (20, 2): 0.31548302332683176, (20, 3): 0.32693452034317516, (20, 4): 0.33879827601894325, (20, 5): 0.3490479339560677, (20, 6): 0.35965892902282554, (20, 7): 0.36819045669965333, (20, 8): 0.37665602951702715, (20, 9): 0.3829260518758695, (20, 10): 0.3887421813688686, (20, 11): 0.3931893899392414, (20, 12): 0.39717179998954755, (20, 13): 0.39991189792049975, (20, 14): 0.40180773555436744, (20, 15): 0.40178228819572803, (20, 16): 0.39983567071045545, (20, 17): 0.39705381332170164, (20, 18): 0.3930400820585352, (20, 19): 0.38856544460779485, (20, 20): 0.382724028741892, (20, 21): 0.37644297961677053, (20, 22): 0.3680083791787587, (20, 23): 0.35950720429509964, (20, 24): 0.3488895681599869, (20, 25): 0.3386560056572656, (20, 26): 0.3268883318170801, (20, 27): 0.3155368291152916, (20, 28): 0.30160972428983857, (20, 29): 0.28824394137931053, (21, 0): 0.33804338965517255, (21, 1): 0.3533562316903266, (21, 2): 0.36930916659989277, (21, 3): 0.3823760640431982, (21, 4): 0.39590092663689636, (21, 5): 0.4075840418956343, (21, 6): 0.4196012879314909, (21, 7): 0.42966012434041767, (21, 8): 0.43968607126040093, (21, 9): 0.446994224819512, (21, 10): 0.45361095097439197, (21, 11): 0.45871067971532403, (21, 12): 0.46325401253186405, (21, 13): 0.46638906055969914, (21, 14): 0.46854331250813996, (21, 15): 0.4685182750141001, (21, 16): 0.46630999843123244, (21, 17): 0.46313863972098596, (21, 18): 0.4585735559886407, (21, 19): 0.4534504800535793, (21, 20): 0.44680010539173254, (21, 21): 0.43947805686671193, (21, 22): 0.42947696056437057, (21, 23): 0.41944409047336156, (21, 24): 0.40743440519554713, (21, 25): 0.39577851405193415, (21, 26): 0.3824065046674968, (21, 27): 0.36948150754703996, (21, 28): 0.35343176361229284, (21, 29): 0.33804338965517255, (22, 0): 0.3854918034482759, (22, 1): 0.4028170540154934, (22, 2): 0.4206149316759935, (22, 3): 0.4353535588641618, (22, 4): 0.450510625044118, (22, 5): 0.46332161822843343, (22, 6): 0.4763481240946476, (22, 7): 0.4876519950352608, (22, 8): 0.4989914852949218, (22, 9): 0.5072861054463729, (22, 10): 0.514715871541714, (22, 11): 0.5203819715997688, (22, 12): 0.5253415221537422, (22, 13): 0.5287865818380191, (22, 14): 0.5311716100300665, (22, 15): 0.53113486443452, (22, 16): 0.5286702858185918, (22, 17): 0.5251865245559459, (22, 18): 0.52023292364505, (22, 19): 0.5145554331442933, (22, 20): 0.5070659199726462, (22, 21): 0.49876070418343904, (22, 22): 0.48749205010634994, (22, 23): 0.47623987082977387, (22, 24): 0.46321169907790727, (22, 25): 0.4504093849441104, (22, 26): 0.4353450904622407, (22, 27): 0.42069851434015226, (22, 28): 0.402844554167209, (22, 29): 0.3854918034482759, (23, 0): 0.4325858551724139, (23, 1): 0.45135494272446647, (23, 2): 0.47067897689983046, (23, 3): 0.48704534479607525, (23, 4): 0.5038501081624922, (23, 5): 0.5177213472175197, (23, 6): 0.531642319757974, (23, 7): 0.5440888525144132, (23, 8): 0.5566015483812913, (23, 9): 0.5659277191827466, (23, 10): 0.5742375562365238, (23, 11): 0.5804587598908382, (23, 12): 0.585751159196659, (23, 13): 0.5894716900132004, (23, 14): 0.5920722066707226, (23, 15): 0.592007283362508, (23, 16): 0.5892696399105405, (23, 17): 0.5854816137528587, (23, 18): 0.5802067314479878, (23, 19): 0.5740024401681261, (23, 20): 0.5656928290164738, (23, 21): 0.5564112322231506, (23, 22): 0.5439910282966767, (23, 23): 0.5315935909064943, (23, 24): 0.517617301054515, (23, 25): 0.5037094990285703, (23, 26): 0.4869905579599083, (23, 27): 0.47071414958450697, (23, 28): 0.4513657445385146, (23, 29): 0.4325858551724139, (24, 0): 0.47838057931034483, (24, 1): 0.49777276971478135, (24, 2): 0.5176368641363203, (24, 3): 0.5356579406346498, (24, 4): 0.5541416478047783, (24, 5): 0.5688330945387489, (24, 6): 0.583343328579821, (24, 7): 0.596272665255792, (24, 8): 0.609178091280644, (24, 9): 0.6194622596971399, (24, 10): 0.6289149823591369, (24, 11): 0.635545429677858, (24, 12): 0.640832322725576, (24, 13): 0.6446261205668327, (24, 14): 0.6473615824888035, (24, 15): 0.647211439216939, (24, 16): 0.6441740609194145, (24, 17): 0.6401829234439638, (24, 18): 0.6348373011065187, (24, 19): 0.6283150290665395, (24, 20): 0.6193065995874394, (24, 21): 0.6093435665383697, (24, 22): 0.5964389625847002, (24, 23): 0.5834294485029262, (24, 24): 0.5686190648366665, (24, 25): 0.5537040282172767, (24, 26): 0.5355129168179081, (24, 27): 0.517768267680997, (24, 28): 0.4978433541805545, (24, 29): 0.47838057931034483, (25, 0): 0.5232623517241379, (25, 1): 0.5430111632178847, (25, 2): 0.5633643711873434, (25, 3): 0.5829385751656173, (25, 4): 0.6029522791476556, (25, 5): 0.6185778801072164, (25, 6): 0.6337983511141916, (25, 7): 0.6470917986185238, (25, 8): 0.6601298411934278, (25, 9): 0.6713958451156637, (25, 10): 0.6820836142332236, (25, 11): 0.6891457728064961, (25, 12): 0.694366164554821, (25, 13): 0.6982485239085419, (25, 14): 0.7011586110867415, (25, 15): 0.7009462898471074, (25, 16): 0.697617721315988, (25, 17): 0.6934454656738102, (25, 18): 0.6881057151202554, (25, 19): 0.6812632064937106, (25, 20): 0.6714896962501552, (25, 21): 0.6607976195091089, (25, 22): 0.6475339077412853, (25, 23): 0.6339569201409105, (25, 24): 0.6182673772205338, (25, 25): 0.6022881450518986, (25, 26): 0.5827270287147903, (25, 27): 0.5635728372354395, (25, 28): 0.543128890576912, (25, 29): 0.5232623517241379, (26, 0): 0.5626664137931034, (26, 1): 0.5838456023592047, (26, 2): 0.6051264856658182, (26, 3): 0.6251400458406559, (26, 4): 0.6453583515525982, (26, 5): 0.6625063788138534, (26, 6): 0.6793220114679472, (26, 7): 0.6920914779879259, (26, 8): 0.7038742096069427, (26, 9): 0.7157410169644179, (26, 10): 0.7277467628505181, (26, 11): 0.7352025202464147, (26, 12): 0.7402317739479258, (26, 13): 0.7442675376005099, (26, 14): 0.7475728526818436, (26, 15): 0.7474692574725094, (26, 16): 0.7439536141721208, (26, 17): 0.7398058881733899, (26, 18): 0.7347895629762315, (26, 19): 0.7277847632719233, (26, 20): 0.7170683489904175, (26, 21): 0.7057596174130991, (26, 22): 0.6927882029671749, (26, 23): 0.6790883769993339, (26, 24): 0.6622017053554481, (26, 25): 0.6450234485994736, (26, 26): 0.6249957943915401, (26, 27): 0.6051551961221102, (26, 28): 0.5838708021247242, (26, 29): 0.5626664137931034, (27, 0): 0.6020289034482759, (27, 1): 0.6242063560736639, (27, 2): 0.6464126053161334, (27, 3): 0.6668722991993127, (27, 4): 0.6872855904070493, (27, 5): 0.7058811924453432, (27, 6): 0.7241972776709633, (27, 7): 0.7365311825744666, (27, 8): 0.7471565758365186, (27, 9): 0.7596078156185678, (27, 10): 0.7727889780658419, (27, 11): 0.7806315405881628, (27, 12): 0.7854240704476414, (27, 13): 0.789616048445234, (27, 14): 0.7933089489312194, (27, 15): 0.7933057272641603, (27, 16): 0.7895974089796233, (27, 17): 0.785453245011893, (27, 18): 0.7807838495840115, (27, 19): 0.7736113576410105, (27, 20): 0.7620172498236228, (27, 21): 0.750079995237961, (27, 22): 0.7374095296378673, (27, 23): 0.7235691462676016, (27, 24): 0.7055970642012828, (27, 25): 0.6872746189740429, (27, 26): 0.6667825013177893, (27, 27): 0.6462584125473892, (27, 28): 0.6241369175109195, (27, 29): 0.6020289034482759, (28, 0): 0.6408509517241381, (28, 1): 0.6633190140784011, (28, 2): 0.6857398545195925, (28, 3): 0.7066796632398785, (28, 4): 0.7273902073727916, (28, 5): 0.7453650903891128, (28, 6): 0.7627457233657615, (28, 7): 0.7759186886007501, (28, 8): 0.7878586175558646, (28, 9): 0.7998541694396403, (28, 10): 0.8117432533720861, (28, 11): 0.8190800102991707, (28, 12): 0.8238576351209401, (28, 13): 0.8279888578029209, (28, 14): 0.831572861530707, (28, 15): 0.8315705624638412, (28, 16): 0.8279788064163771, (28, 17): 0.8238713692707063, (28, 18): 0.8191557392580542, (28, 19): 0.812148958596318, (28, 20): 0.8010654291483679, (28, 21): 0.7893486932550446, (28, 22): 0.7763679954374012, (28, 23): 0.7624224352645487, (28, 24): 0.7452211093842451, (28, 25): 0.7273883596380649, (28, 26): 0.7066401999124824, (28, 27): 0.6856660558866281, (28, 28): 0.6632852952712716, (28, 29): 0.6408509517241381, (29, 0): 0.679673, (29, 1): 0.7024119448275862, (29, 2): 0.7251508896551724, (29, 3): 0.7465763862068966, (29, 4): 0.7679008482758621, (29, 5): 0.7850431862068966, (29, 6): 0.8014885034482758, (29, 7): 0.8155186, (29, 8): 0.82889, (29, 9): 0.8403869517241379, (29, 10): 0.851134124137931, (29, 11): 0.8579198068965517, (29, 12): 0.8625046620689655, (29, 13): 0.866608, (29, 14): 0.8703502, (29, 15): 0.8703502, (29, 16): 0.8666079999999999, (29, 17): 0.8625046620689655, (29, 18): 0.8579198068965517, (29, 19): 0.8511341241379309, (29, 20): 0.8403869517241379, (29, 21): 0.82889, (29, 22): 0.8155186000000001, (29, 23): 0.8014885034482759, (29, 24): 0.7850431862068966, (29, 25): 0.7679008482758621, (29, 26): 0.7465763862068966, (29, 27): 0.7251508896551724, (29, 28): 0.7024119448275862, (29, 29): 0.679673}


if __name__ == "__main__":
    unittest.main()


