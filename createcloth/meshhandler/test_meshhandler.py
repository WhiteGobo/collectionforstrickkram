import unittest
import importlib.resources
import os.path
import networkx as netx
import numpy as np
import tempfile

#from . import PlySurfaceHandler
from ..meshhandler import plysurfacehandler, relax_gridgraph
#from .new_gridrelaxator import relax_gridgraph
from . import test_src

#from ..strickgraph import strickgraph_fromgrid as fromgrid
from ..strickgraph import strickgraph
from ..stitchinfo import basic_stitchdata as stinfo

class TestMeshhandlerMethods( unittest.TestCase ):
    def setUp( self ):
        self.testmeshfilename = "meshfortests.ply"
        pass

    @unittest.skip( "need to much time" )
    def test_createsurfacemap( self ):
        with importlib.resources.path( test_src, "tester.ply" ) as filepath:
            #q = PlySurfaceHandler.plysurfacehandler.load_from_file( filepath )
            q = plysurfacehandler.load_from_file( filepath )
        #mysurfacemap = surfacemap.from_surface( mysurface )
        #surfmap = q.create_surfacemap( 0 )
        q.complete_surfaces_with_map()
        mysurfacemap = q.get_surface( 0 ).get_surfacemap()
        #mysurfacemap.visualize_with_matplotlib()

        with tempfile.TemporaryDirectory() as tmpdir:
            myfilepath = os.path.join( tmpdir, "surfmap.ply" )
            q.save_to_file( myfilepath )
            #mysurfacemap.to_plyfile( myfilepath )
            #copy_surfmap = surfacemap.from_plyfile( myfilepath )


    def test_wholerelaxing( self ):
        with importlib.resources.path( test_src, "surfmap.ply" ) as filepath:
            #q = PlySurfaceHandler.plysurfacehandler.load_from_file( filepath )
            q = plysurfacehandler.load_from_file( filepath )
        mysurfacemap = q.get_surface( 0 ).get_surfacemap()
        mygraph = netx.grid_2d_graph( 30, 30 )
        firstrow = [ x for x in mygraph.nodes() if x[0] == 0 ]
        gridgraph = strickgraph.from_gridgraph( mygraph, firstrow, stinfo )
        #gridgraph = fromgrid.create_strickgraph_from_gridgraph( mygraph, \
        #                                                firstrow, \
        #                                                stinfo )

        border = gridgraph.get_borders()
        positions = relax_gridgraph( gridgraph, mysurfacemap )

        if False:
            from ..visualizer import myvis3d
            myvis3d( gridgraph )

        xpos = { node:valdict["x"] for node, valdict in positions.items() }
        #ypos = netx.get_node_attributes( gridgraph, "y" )
        #zpos = netx.get_node_attributes( gridgraph, "z" )
        realnodes = list( gridgraph.get_nodes() )
        testarray = [ test[node] for node in realnodes ]
        xposarray = [ xpos[node] for node in realnodes ]
        tmpbool = np.allclose( xposarray, testarray, atol=0.1 )
        self.assertTrue( tmpbool, msg="wholerelaxing didnt gave exact position back" )
        return 

test = {(0, 0): 0.679673, (0, 1): 0.6408509517241381, (0, 2): 0.6020289034482759, (0, 3): 0.5626664137931034, (0, 4): 0.5232623517241379, (0, 5): 0.47838057931034483, (0, 6): 0.4325858551724139, (0, 7): 0.3854918034482759, (0, 8): 0.33804338965517255, (0, 9): 0.28824394137931053, (0, 10): 0.2375040793103449, (0, 11): 0.1855620655172415, (0, 12): 0.13295218965517258, (0, 13): 0.07994865457211038, (0, 14): 0.026649875073303346, (0, 15): -0.02664892147842073, (0, 16): -0.07994773508306202, (0, 17): -0.13295124827586194, (0, 18): -0.18556102758620685, (0, 19): -0.237503048275862, (0, 20): -0.28824310344827586, (0, 21): -0.33804268965517237, (0, 22): -0.38549110344827575, (0, 23): -0.43258513448275865, (0, 24): -0.4783797620689655, (0, 25): -0.5232614448275862, (0, 26): -0.5626654586206897, (0, 27): -0.602027903448276, (0, 28): -0.640849951724138, (0, 29): -0.679672, (1, 29): -0.7024111379310345, (1, 28): -0.6633091514847311, (1, 27): -0.6241826560851685, (1, 26): -0.5839895994749243, (1, 25): -0.5433112113655398, (1, 24): -0.49799378649386344, (1, 23): -0.4514477583374049, (1, 22): -0.40293185613471877, (1, 21): -0.3534876949002388, (1, 20): -0.3016923951505046, (1, 19): -0.2487235695541578, (1, 18): -0.19450572169849567, (1, 17): -0.1395534245317534, (1, 16): -0.08395258660578389, (1, 15): -0.028000471465160798, (1, 14): 0.028053216705661188, (1, 13): 0.08397644714940183, (1, 12): 0.1395517307698756, (1, 11): 0.1945177822284132, (1, 10): 0.24872253258644764, (1, 9): 0.30160528081251714, (1, 8): 0.3533420279714264, (1, 7): 0.40282758258274776, (1, 6): 0.4513441498486921, (1, 5): 0.4977812341229999, (1, 4): 0.5430108206275958, (1, 3): 0.5838528247507384, (1, 2): 0.6242082715837052, (1, 1): 0.6633199999399797, (1, 0): 0.7024119448275862, (2, 0): 0.7251508896551724, (2, 1): 0.6857386810740513, (2, 2): 0.6464146542218385, (2, 3): 0.6051282073540012, (2, 4): 0.5633729406307812, (2, 5): 0.5176380750096403, (2, 6): 0.47069208856410316, (2, 7): 0.4206175050573052, (2, 8): 0.3693341887705157, (2, 9): 0.3154835815246425, (2, 10): 0.26049586817162335, (2, 11): 0.20385298234155244, (2, 12): 0.14642956578935648, (2, 13): 0.08817189085073149, (2, 14): 0.029503870247585114, (2, 15): -0.02938570006964516, (2, 16): -0.08812286857192939, (2, 17): -0.14644072275708994, (2, 18): -0.2038406335736046, (2, 19): -0.26051085344347974, (2, 20): -0.31567059002470327, (2, 21): -0.3696338781833963, (2, 22): -0.420833589932299, (2, 23): -0.47088658028942976, (2, 24): -0.5180223907012705, (2, 25): -0.5639100331726146, (2, 26): -0.6053548651251068, (2, 27): -0.6463293945401017, (2, 28): -0.6857012068682642, (2, 29): -0.725150275862069, (3, 29): -0.7465759206896552, (3, 28): -0.7062746917275345, (3, 27): -0.6660591368113012, (3, 26): -0.6247607831041995, (3, 25): -0.5830127348944598, (3, 24): -0.5357942409110318, (3, 23): -0.4871760860189921, (3, 22): -0.43551704587676027, (3, 21): -0.38255056459198233, (3, 20): -0.32704437411465626, (3, 19): -0.27021415676716687, (3, 18): -0.2116394312866021, (3, 17): -0.15210440042355194, (3, 16): -0.09156630056268943, (3, 15): -0.030532658309933625, (3, 14): 0.03068131960821787, (3, 13): 0.09168098679801095, (3, 12): 0.15217905475102572, (3, 11): 0.2116926829238659, (3, 10): 0.27021805084133005, (3, 9): 0.3269394050522021, (3, 8): 0.3823654644091656, (3, 7): 0.43535580743687774, (3, 6): 0.48703119052374794, (3, 5): 0.5356586872046462, (3, 4): 0.5829332405616534, (3, 3): 0.6251408062704782, (3, 2): 0.6668701243250591, (3, 1): 0.7066771306472525, (3, 0): 0.7465763862068966, (4, 0): 0.7679008482758621, (4, 1): 0.7273870263776366, (4, 2): 0.6872801161608956, (4, 3): 0.6453607557467058, (4, 4): 0.6029530541422459, (4, 5): 0.554145419610143, (4, 6): 0.5038487902186591, (4, 7): 0.45051315675913856, (4, 8): 0.39590121979086934, (4, 9): 0.33879500799519247, (4, 10): 0.2803708102912965, (4, 11): 0.2198627641485541, (4, 12): 0.1582002613591882, (4, 13): 0.09534804393801109, (4, 14): 0.031914242508354486, (4, 15): -0.03173251417106685, (4, 16): -0.0951630535668857, (4, 17): -0.15803693968717325, (4, 18): -0.21977843266080366, (4, 19): -0.280358646111308, (4, 20): -0.3388058151967124, (4, 21): -0.3959388522620414, (4, 22): -0.4505931907256596, (4, 23): -0.5039231801015509, (4, 24): -0.5539872069226112, (4, 25): -0.6025098427222804, (4, 26): -0.6442846105433435, (4, 27): -0.6856479836584947, (4, 28): -0.7265552363238367, (4, 29): -0.767900527586207, (5, 29): -0.7850428448275861, (5, 28): -0.744876991319176, (5, 27): -0.7049001628346496, (5, 26): -0.661890687490732, (5, 25): -0.6183679183975738, (5, 24): -0.5687885676403385, (5, 23): -0.5178002929448022, (5, 22): -0.46339015762158825, (5, 21): -0.4075986960911347, (5, 20): -0.3489932183265431, (5, 19): -0.2889603934614272, (5, 18): -0.2265746083904624, (5, 17): -0.1629306006881706, (5, 16): -0.09810639200350027, (5, 15): -0.03270800292902302, (5, 14): 0.032917383620663654, (5, 13): 0.0983360862602498, (5, 12): 0.16316366681756117, (5, 11): 0.2267541762932016, (5, 10): 0.28907895510540704, (5, 9): 0.3490432323766468, (5, 8): 0.4075762876468505, (5, 7): 0.4633211759080338, (5, 6): 0.5177175852990321, (5, 5): 0.5688358528265529, (5, 4): 0.6185801565731386, (5, 3): 0.6625063045982854, (5, 2): 0.7058835606473052, (5, 1): 0.7453622612523816, (5, 0): 0.7850431862068966, (6, 0): 0.8014885034482758, (6, 1): 0.7627459994739096, (6, 2): 0.7241967741682945, (6, 3): 0.6793275448594069, (6, 4): 0.6338014267190504, (6, 5): 0.5833475390502139, (6, 6): 0.5316422766659219, (6, 7): 0.47634969996458565, (6, 8): 0.41959957315237917, (6, 9): 0.35965457754709007, (6, 10): 0.2981213946187142, (6, 11): 0.23390895954065039, (6, 12): 0.16830045170101787, (6, 13): 0.10142434864441269, (6, 14): 0.033947600764728386, (6, 15): -0.03372817473970014, (6, 16): -0.10116102040500041, (6, 17): -0.16799598974098678, (6, 18): -0.23361013202796227, (6, 19): -0.2978653538839808, (6, 20): -0.3595408414177635, (6, 21): -0.4196199206877875, (6, 22): -0.4764097280295969, (6, 23): -0.5317397813772347, (6, 24): -0.5834765430511805, (6, 25): -0.6339492635324203, (6, 26): -0.6793943013162764, (6, 27): -0.7241374986010547, (6, 28): -0.7627295192341088, (6, 29): -0.8014881137931035, (7, 29): -0.8155180862068966, (7, 28): -0.7766471823392119, (7, 27): -0.7379743166508757, (7, 26): -0.6930529961557764, (7, 25): -0.6474647036870401, (7, 24): -0.5965272639389934, (7, 23): -0.5442914686364573, (7, 22): -0.4877645209342816, (7, 21): -0.42966750724340463, (7, 20): -0.36807748769451687, (7, 19): -0.3048597119758713, (7, 18): -0.23909017088590864, (7, 17): -0.17198275651313452, (7, 16): -0.10357210037948608, (7, 15): -0.034528879085629155, (7, 14): 0.03476181446429448, (7, 13): 0.10382510886355269, (7, 12): 0.17225015144101208, (7, 11): 0.23935033230314678, (7, 10): 0.3050825432155259, (7, 9): 0.3681871345703347, (7, 8): 0.429655749092836, (7, 7): 0.48765134481659084, (7, 6): 0.5440836177932952, (7, 5): 0.5962732172404083, (7, 4): 0.647092648923855, (7, 3): 0.6920938034510411, (7, 2): 0.7365371692516938, (7, 1): 0.7759165997972657, (7, 0): 0.8155186, (8, 0): 0.82889, (8, 1): 0.7878577784313321, (8, 2): 0.7471517213078244, (8, 3): 0.7038805415104318, (8, 4): 0.6601317656195633, (8, 5): 0.609180561506719, (8, 6): 0.5565998132573402, (8, 7): 0.4989916284776804, (8, 8): 0.4396862716222072, (8, 9): 0.37665587372416554, (8, 10): 0.31194246776453344, (8, 11): 0.2447322239833795, (8, 12): 0.176183439885768, (8, 13): 0.10622579403366597, (8, 14): 0.03557709381832205, (8, 15): -0.035342081948412186, (8, 16): -0.10600625509649172, (8, 17): -0.1759885419165251, (8, 18): -0.24455645565916995, (8, 19): -0.31179957437409234, (8, 20): -0.37657052285225456, (8, 21): -0.4396918499804945, (8, 22): -0.4991765837210276, (8, 23): -0.5569409273939783, (8, 24): -0.6095313504135909, (8, 25): -0.660683751452148, (8, 26): -0.7058046948732306, (8, 27): -0.7502468700830908, (8, 28): -0.789432466819601, (8, 29): -0.8288893413793104, (9, 29): -0.8403861482758621, (9, 28): -0.8010666044949175, (9, 27): -0.7620340798399547, (9, 26): -0.7170539364530816, (9, 25): -0.6714342378216711, (9, 24): -0.6194798373567072, (9, 23): -0.5661174024226303, (9, 22): -0.5074038180705623, (9, 21): -0.4469810618287903, (9, 20): -0.3828468847811368, (9, 19): -0.31706016011613186, (9, 18): -0.24873025006062022, (9, 17): -0.17904417568202646, (9, 16): -0.10787224771441076, (9, 15): -0.0359757080761175, (9, 14): 0.03621730282046625, (9, 13): 0.1080941611405552, (9, 12): 0.1792340757567339, (9, 11): 0.24889295692257687, (9, 10): 0.31718536234716393, (9, 9): 0.3829254320102616, (9, 8): 0.4469943575044224, (9, 7): 0.5072877052184217, (9, 6): 0.5659277914805295, (9, 5): 0.6194654774670446, (9, 4): 0.671400404265286, (9, 3): 0.7157405333379491, (9, 2): 0.7596092308910286, (9, 1): 0.799848653631896, (9, 0): 0.8403869517241379, (10, 0): 0.851134124137931, (10, 1): 0.8117399267705399, (10, 2): 0.7727833066351761, (10, 3): 0.7277518455418799, (10, 4): 0.6820881337197257, (10, 5): 0.6289206445680675, (10, 6): 0.5742399524568057, (10, 7): 0.5147204899983763, (10, 8): 0.45361358654696204, (10, 9): 0.38874403939743185, (10, 10): 0.3221890647575636, (10, 11): 0.25292924314254495, (10, 12): 0.1822224901226026, (10, 13): 0.10993765155881502, (10, 14): 0.03685103585257692, (10, 15): -0.036600786987134044, (10, 16): -0.10970338587466247, (10, 17): -0.1820171201309984, (10, 18): -0.2527649239648603, (10, 19): -0.3220696809603755, (10, 20): -0.3886735499682345, (10, 21): -0.45358729045863044, (10, 22): -0.5147351974964907, (10, 23): -0.5741968158113346, (10, 24): -0.628443359345898, (10, 25): -0.6813212043012501, (10, 26): -0.7277998266408359, (10, 27): -0.7735536880660083, (10, 28): -0.812119041789055, (10, 29): -0.851133175862069, (11, 29): -0.8579188068965518, (11, 28): -0.8191296783166954, (11, 27): -0.7807472361408027, (11, 26): -0.7348213406554579, (11, 25): -0.6881961891789695, (11, 24): -0.634957326623858, (11, 23): -0.5803443751284061, (11, 22): -0.5203717116929291, (11, 21): -0.45869312151890806, (11, 20): -0.39314233251101516, (11, 19): -0.3258724194977111, (11, 18): -0.25580329248564615, (11, 17): -0.18424598387866242, (11, 16): -0.11105906953393321, (11, 15): -0.03706246959698433, (11, 14): 0.037308292743654436, (11, 13): 0.11128498791403099, (11, 12): 0.1844379834766008, (11, 11): 0.2559470946466151, (11, 10): 0.3259673775832246, (11, 9): 0.3931899085331078, (11, 8): 0.45871015203524607, (11, 7): 0.52038599277009, (11, 6): 0.5804610190389486, (11, 5): 0.6355502278287607, (11, 4): 0.689151006223321, (11, 3): 0.7352054244934781, (11, 2): 0.7806354831413195, (11, 1): 0.8190738378290053, (11, 0): 0.8579198068965517, (12, 0): 0.8625046620689655, (12, 1): 0.8238580745431419, (12, 2): 0.7854215256144301, (12, 3): 0.7402401636845872, (12, 4): 0.6943729209505831, (12, 5): 0.6408388038848662, (12, 6): 0.5857548340584638, (12, 7): 0.5253459810017354, (12, 8): 0.4632557512143379, (12, 9): 0.3971726946412724, (12, 10): 0.32934932272606554, (12, 11): 0.25864775140319207, (12, 12): 0.18641700362221272, (12, 13): 0.11248358791944463, (12, 14): 0.037699483358606053, (12, 15): -0.03748461876304494, (12, 16): -0.11229050781374057, (12, 17): -0.1862584614683425, (12, 18): -0.25854094926298055, (12, 19): -0.32928841178728846, (12, 20): -0.3971588412545556, (12, 21): -0.4632671595934561, (12, 22): -0.5253567509212754, (12, 23): -0.5856711877513046, (12, 24): -0.6403324802274081, (12, 25): -0.6935455839168493, (12, 26): -0.7398745606150577, (12, 27): -0.7854707115643655, (12, 28): -0.823882547587026, (12, 29): -0.8625036620689656, (13, 29): -0.8666069999999999, (13, 28): -0.8280451610267627, (13, 27): -0.7897353910021943, (13, 26): -0.7441657419140845, (13, 25): -0.6978953023137395, (13, 24): -0.6444782570252348, (13, 23): -0.5895857429921427, (13, 22): -0.52890680665787, (13, 21): -0.4664493956061347, (13, 20): -0.3998835124039281, (13, 19): -0.3315574990356807, (13, 18): -0.2603164767910969, (13, 17): -0.1875486287516877, (13, 16): -0.11307886594510179, (13, 15): -0.03776426562522648, (13, 14): 0.03791979242484847, (13, 13): 0.11323315114330589, (13, 12): 0.18771036747518605, (13, 11): 0.2604677257721882, (13, 10): 0.3316833407925795, (13, 9): 0.3999111603978717, (13, 8): 0.46638928199135576, (13, 7): 0.5287904500846883, (13, 6): 0.5894735386688684, (13, 5): 0.6446314157792636, (13, 4): 0.6982549177395658, (13, 3): 0.7442710462101114, (13, 2): 0.7896178965699315, (13, 1): 0.8279857351649296, (13, 0): 0.866608, (14, 0): 0.8703502, (14, 1): 0.831567909718756, (14, 2): 0.7933076321467134, (14, 3): 0.7475761011265544, (14, 4): 0.701162345052241, (14, 5): 0.6473662474575734, (14, 6): 0.5920732437067021, (14, 7): 0.5311749064708627, (14, 8): 0.4685430251614997, (14, 9): 0.40180776140108654, (14, 10): 0.3333086804136878, (14, 11): 0.26171503843194455, (14, 12): 0.18854470062240344, (14, 13): 0.11368580140123319, (14, 14): 0.03802930568109933, (14, 15): -0.037958233265806, (14, 16): -0.11356905099994465, (14, 17): -0.18834820407224245, (14, 18): -0.26144143194916114, (14, 19): -0.3330264205410734, (14, 20): -0.4017205279740308, (14, 21): -0.4686629472155555, (14, 22): -0.5314621071767017, (14, 23): -0.5925089704647817, (14, 24): -0.6477721894241647, (14, 25): -0.7015319105715624, (14, 26): -0.7479208898065643, (14, 27): -0.7936034535705868, (14, 28): -0.8317181370333077, (14, 29): -0.8703492, (15, 29): -0.8703491999999999, (15, 28): -0.831724137507966, (15, 27): -0.7936133981591447, (15, 26): -0.7480585736691645, (15, 25): -0.7018073644242147, (15, 24): -0.6479560764532453, (15, 23): -0.592573078989909, (15, 22): -0.5315058599590006, (15, 21): -0.4687117186046293, (15, 20): -0.40177180877917734, (15, 19): -0.3330813019805796, (15, 18): -0.2614958272751861, (15, 17): -0.1884085336187957, (15, 16): -0.11362325686770207, (15, 15): -0.03800721089109103, (15, 14): 0.03797447710151794, (15, 13): 0.11363684032749577, (15, 12): 0.18850237947754805, (15, 11): 0.2616776114119249, (15, 10): 0.33327809439470263, (15, 9): 0.4017821586343251, (15, 8): 0.46851786496916514, (15, 7): 0.5311380844339231, (15, 6): 0.5920081733256212, (15, 5): 0.6472159139681894, (15, 4): 0.7009493948754674, (15, 3): 0.7474722317424538, (15, 2): 0.7933042457937716, (15, 1): 0.8315655122407799, (15, 0): 0.8703502, (16, 0): 0.8666079999999999, (16, 1): 0.8279756752507192, (16, 2): 0.7895988602175923, (16, 3): 0.7439561032754725, (16, 4): 0.6976230069973757, (16, 5): 0.644178137645046, (16, 6): 0.5892710980750214, (16, 7): 0.5286741150976324, (16, 8): 0.46630994485527366, (16, 9): 0.39983441803334707, (16, 10): 0.33159690429468014, (16, 11): 0.26036642502239093, (16, 12): 0.18759508134212277, (16, 13): 0.11309444985370354, (16, 14): 0.037764143995984385, (16, 15): -0.037907392498339895, (16, 16): -0.11323524300858628, (16, 17): -0.18772069716300774, (16, 18): -0.26047485217552196, (16, 19): -0.33171503320601126, (16, 20): -0.4000350752491763, (16, 21): -0.4665982714010272, (16, 22): -0.5290471994803961, (16, 23): -0.5897899823052627, (16, 24): -0.6450370634260127, (16, 25): -0.698719690093566, (16, 26): -0.7445865098571142, (16, 27): -0.7897763429389308, (16, 28): -0.8280659177834849, (16, 29): -0.866607, (17, 29): -0.8625036620689654, (17, 28): -0.8238786302954297, (17, 27): -0.7854650553628748, (17, 26): -0.7403761754761226, (17, 25): -0.6945945100918355, (17, 24): -0.6410667099319795, (17, 23): -0.5859726291835932, (17, 22): -0.5255825104573129, (17, 21): -0.4635053983940769, (17, 20): -0.3974034327403514, (17, 19): -0.3295449230175635, (17, 18): -0.25879472150290833, (17, 17): -0.18652756700232337, (17, 16): -0.1125339108596957, (17, 15): -0.03770820129325986, (17, 14): 0.03745421468285979, (17, 13): 0.11225906769176704, (17, 12): 0.18622501291926533, (17, 11): 0.2584831555177173, (17, 10): 0.32921323028755906, (17, 9): 0.3970542740944358, (17, 8): 0.46314040580088334, (17, 7): 0.525190931840952, (17, 6): 0.585484628211852, (17, 5): 0.640187730355088, (17, 4): 0.6934506963767985, (17, 3): 0.7398131625431758, (17, 2): 0.7854504352648937, (17, 1): 0.8238721393356847, (17, 0): 0.8625046620689655, (18, 0): 0.8579198068965517, (18, 1): 0.8191503299680598, (18, 2): 0.7807882243964449, (18, 3): 0.7347918301379788, (18, 4): 0.6881093468744528, (18, 5): 0.6348408897403462, (18, 6): 0.5802082042918162, (18, 7): 0.520237047418, (18, 8): 0.45857323715895837, (18, 9): 0.3930401633642322, (18, 10): 0.32579766773290475, (18, 11): 0.2557395741363821, (18, 12): 0.18419327688440268, (18, 13): 0.1110006964276644, (18, 14): 0.03699948337472793, (18, 15): -0.03734845652346094, (18, 16): -0.11136604198541329, (18, 17): -0.18458136810883785, (18, 18): -0.25612274010843333, (18, 19): -0.32619332854277683, (18, 20): -0.3934516529908188, (18, 21): -0.4589946039445676, (18, 22): -0.5206597452807011, (18, 23): -0.5806817510546063, (18, 24): -0.6356018282791126, (18, 25): -0.6890423822522851, (18, 26): -0.7351388628937618, (18, 27): -0.7805983028392536, (18, 28): -0.8190528255844787, (18, 29): -0.8579188068965518, (19, 29): -0.851133175862069, (19, 28): -0.8120218396169989, (19, 27): -0.7733702182992369, (19, 26): -0.7280491586229367, (19, 25): -0.6820716624081322, (19, 24): -0.6290189094262061, (19, 23): -0.5745036163383211, (19, 22): -0.515020591154426, (19, 21): -0.4539090661093189, (19, 20): -0.3890153431939255, (19, 19): -0.3224308174476588, (19, 18): -0.25312811834010174, (19, 17): -0.1823907289555958, (19, 16): -0.11005184518239194, (19, 15): -0.036930546037849524, (19, 14): 0.03650857916396884, (19, 13): 0.10961758697078008, (19, 12): 0.1819439410224953, (19, 11): 0.25269274760676885, (19, 10): 0.3219898040983795, (19, 9): 0.38856727269499425, (19, 8): 0.45345302199548965, (19, 7): 0.51456005857441, (19, 6): 0.5740044095514567, (19, 5): 0.628319183599141, (19, 4): 0.6812659744489135, (19, 3): 0.7277889406010485, (19, 2): 0.7736071247818379, (19, 1): 0.812146647234982, (19, 0): 0.8511341241379309, (20, 0): 0.8403869517241379, (20, 1): 0.8010602620722687, (20, 2): 0.7620197578760665, (20, 3): 0.7170663599723167, (20, 4): 0.6714925110964457, (20, 5): 0.6193081095298631, (20, 6): 0.5656922922211842, (20, 7): 0.5070670830348327, (20, 8): 0.446799400541424, (20, 9): 0.38272266587185755, (20, 10): 0.31696737457884244, (20, 11): 0.24865276506443632, (20, 12): 0.17896636105356373, (20, 13): 0.10779039900808099, (20, 14): 0.035876001090450735, (20, 15): -0.03634394346325697, (20, 16): -0.10825788932690136, (20, 17): -0.1794328664919383, (20, 18): -0.24911016694136065, (20, 19): -0.317430002977402, (20, 20): -0.3831805320615923, (20, 21): -0.44726763230683625, (20, 22): -0.507601316099757, (20, 23): -0.5663067914651995, (20, 24): -0.6200182805543367, (20, 25): -0.6722366079611057, (20, 26): -0.7174259831820411, (20, 27): -0.7620142123715365, (20, 28): -0.8010580694338909, (20, 29): -0.8403861482758621, (21, 29): -0.8288893413793104, (21, 28): -0.7893779454934291, (21, 27): -0.7501213367553219, (21, 26): -0.7061199027090855, (21, 25): -0.6614709540976476, (21, 24): -0.6100244578160919, (21, 23): -0.5570487718652957, (21, 22): -0.49930877084134917, (21, 21): -0.43994452043720406, (21, 20): -0.3768866428380564, (21, 19): -0.3121561417871669, (21, 18): -0.24495378382990612, (21, 17): -0.17642342933058153, (21, 16): -0.1064458449034719, (21, 15): -0.035744305220092074, (21, 14): 0.0352497477155525, (21, 13): 0.10594969396255532, (21, 12): 0.17593745037196384, (21, 11): 0.2445035925219691, (21, 10): 0.3117204053307123, (21, 9): 0.3764415023179585, (21, 8): 0.4394771033425141, (21, 7): 0.4987608165388628, (21, 6): 0.556409710550334, (21, 5): 0.6093450843454267, (21, 4): 0.6607980170914792, (21, 3): 0.7057649689931658, (21, 2): 0.750074991117248, (21, 1): 0.7893482646603576, (21, 0): 0.82889, (22, 0): 0.8155186000000001, (22, 1): 0.7763656016902687, (22, 2): 0.7374155327574031, (22, 3): 0.6927901393261404, (22, 4): 0.6475344876813125, (22, 5): 0.5964402617450045, (22, 6): 0.5439874118087721, (22, 7): 0.48749252746543337, (22, 8): 0.42947206904772256, (22, 9): 0.3680045118277586, (22, 10): 0.30490764879905036, (22, 11): 0.2391648953026196, (22, 12): 0.17203838038407826, (22, 13): 0.10357919681350922, (22, 14): 0.034450806158672756, (22, 15): -0.03495826784781628, (22, 16): -0.10411232672513132, (22, 17): -0.17254911178477994, (22, 18): -0.2395315590672909, (22, 19): -0.3051846364056121, (22, 20): -0.36838239910538867, (22, 21): -0.42993094333074977, (22, 22): -0.487949651044173, (22, 23): -0.5444747319563701, (22, 24): -0.5970107656954052, (22, 25): -0.648111750194319, (22, 26): -0.6928939072268171, (22, 27): -0.7370707404474857, (22, 28): -0.7761987901217072, (22, 29): -0.8155180862068965, (23, 29): -0.8014881137931035, (23, 28): -0.7621334517361327, (23, 27): -0.7230127129516258, (23, 26): -0.6790642310533302, (23, 25): -0.634502541449407, (23, 24): -0.5839324736168449, (23, 23): -0.5319471350490462, (23, 22): -0.4766029608854869, (23, 21): -0.41986716059178114, (23, 20): -0.3598200099044906, (23, 19): -0.2981566089280022, (23, 18): -0.23407149612135067, (23, 17): -0.16864526800101698, (23, 16): -0.10175931668879054, (23, 15): -0.03415611170340465, (23, 14): 0.033676726395008245, (23, 13): 0.1012315144179738, (23, 12): 0.16813856883488681, (23, 11): 0.2337724165670777, (23, 10): 0.29799105624849054, (23, 9): 0.3595023431009966, (23, 8): 0.4194434437265122, (23, 7): 0.4762430689473781, (23, 6): 0.5315953646431483, (23, 5): 0.583434513019194, (23, 4): 0.6339601576581757, (23, 3): 0.6790943568207402, (23, 2): 0.723569418688082, (23, 1): 0.7624230515719528, (23, 0): 0.8014885034482759, (24, 0): 0.7850431862068966, (24, 1): 0.7452188686778956, (24, 2): 0.7055999817218267, (24, 3): 0.6622013903475463, (24, 4): 0.6182687533955176, (24, 5): 0.5686218577186183, (24, 6): 0.5176137932266329, (24, 7): 0.4632125390856791, (24, 8): 0.40742745350178383, (24, 9): 0.3488844779687743, (24, 10): 0.2889216622292887, (24, 11): 0.2266022208487818, (24, 12): 0.16300753500109477, (24, 13): 0.09815527043049319, (24, 14): 0.03266834352756237, (24, 15): -0.03307599658733949, (24, 16): -0.09858662210190249, (24, 17): -0.16343499464630035, (24, 18): -0.2269413670077939, (24, 19): -0.28920440185197155, (24, 20): -0.3492222384153795, (24, 21): -0.4077816542217717, (24, 22): -0.4634885317209638, (24, 23): -0.5178835294943969, (24, 24): -0.5691496812392587, (24, 25): -0.6189574438250747, (24, 26): -0.6623800064610368, (24, 27): -0.7052893659264112, (24, 28): -0.7450598203650738, (24, 29): -0.7850428448275861, (25, 29): -0.767900527586207, (25, 28): -0.7273347500361117, (25, 27): -0.6871800859264772, (25, 26): -0.6453510564214399, (25, 25): -0.6030470478790217, (25, 24): -0.5542067449736968, (25, 23): -0.5038646671985694, (25, 22): -0.45058388289394385, (25, 21): -0.3960511192324998, (25, 20): -0.3389836651092088, (25, 19): -0.2805669808608691, (25, 18): -0.220068519624082, (25, 17): -0.15841283096744624, (25, 16): -0.09552874191013772, (25, 15): -0.03202901825531741, (25, 14): 0.03170144670125835, (25, 13): 0.09519397548412725, (25, 12): 0.15806491686433732, (25, 11): 0.21970905441699512, (25, 10): 0.2802047677801064, (25, 9): 0.3386521096759407, (25, 8): 0.3957784653104715, (25, 7): 0.4504118424337802, (25, 6): 0.5037084126395777, (25, 5): 0.5537064469589107, (25, 4): 0.602287869530195, (25, 3): 0.6450249696150494, (25, 2): 0.6872699794723586, (25, 1): 0.7273855978774967, (25, 0): 0.7679008482758621, (26, 0): 0.7465763862068966, (26, 1): 0.7066385529755254, (26, 2): 0.6667814259046537, (26, 3): 0.624997635227635, (26, 4): 0.5827210828595671, (26, 5): 0.5355135940028231, (26, 6): 0.4869758248118601, (26, 7): 0.43534708089807117, (26, 8): 0.3823966978812863, (26, 9): 0.3268920832538438, (26, 10): 0.27005222573104176, (26, 11): 0.21152323744854837, (26, 12): 0.15204782112260898, (26, 13): 0.09152585660895507, (26, 14): 0.030481856329804588, (26, 15): -0.030752820516718477, (26, 16): -0.09178587010285484, (26, 17): -0.15230704452310956, (26, 18): -0.21180677034079126, (26, 19): -0.2703411983277293, (26, 20): -0.3271239781235232, (26, 21): -0.38254935917474475, (26, 22): -0.43537409469829735, (26, 23): -0.4869307495660137, (26, 24): -0.5356785209639895, (26, 25): -0.5830556029878571, (26, 26): -0.6251867354075302, (26, 27): -0.6668407503926612, (26, 28): -0.7066629388789852, (26, 29): -0.7465759206896552, (27, 29): -0.7251502758620689, (27, 28): -0.685754248524037, (27, 27): -0.6464470742715479, (27, 26): -0.6052183517622634, (27, 25): -0.5635217987515622, (27, 24): -0.5176277457653657, (27, 23): -0.4704982289978741, (27, 22): -0.4205938904616443, (27, 21): -0.3695481717839289, (27, 20): -0.3156677714024922, (27, 19): -0.26056032151255887, (27, 18): -0.2038936843141248, (27, 17): -0.14648817039646894, (27, 16): -0.08821348596676004, (27, 15): -0.029534433264545457, (27, 14): 0.029327000343692157, (27, 13): 0.08803359398164985, (27, 12): 0.1463249147763409, (27, 11): 0.20369692060148592, (27, 10): 0.260354922127528, (27, 9): 0.3155383824840303, (27, 8): 0.36950817085707865, (27, 7): 0.4207011801333303, (27, 6): 0.4707269952427108, (27, 5): 0.5177692535326514, (27, 4): 0.5635827174376106, (27, 3): 0.6051588601096302, (27, 2): 0.6462622059878863, (27, 1): 0.685665756846736, (27, 0): 0.7251508896551724, (28, 0): 0.7024119448275862, (28, 1): 0.6632866459782056, (28, 2): 0.62413999003487, (28, 3): 0.5838796522279504, (28, 4): 0.5431293062932286, (28, 5): 0.49785253585355727, (28, 6): 0.451354118653636, (28, 7): 0.4028535712805874, (28, 8): 0.35341706042390353, (28, 9): 0.301618527168396, (28, 10): 0.24864147397859215, (28, 11): 0.19442874521526846, (28, 12): 0.13948894820791918, (28, 13): 0.08390194131606399, (28, 14): 0.027966733932834997, (28, 15): -0.028071433033883594, (28, 16): -0.08399716949868725, (28, 17): -0.13957886928356783, (28, 18): -0.19453501854910166, (28, 19): -0.2487506306035573, (28, 20): -0.3016881397645256, (28, 21): -0.35343983062929835, (28, 22): -0.4028055891827069, (28, 23): -0.45124144049741216, (28, 24): -0.49777498676746457, (28, 25): -0.543089263713026, (28, 26): -0.5839000324978044, (28, 27): -0.6242250737849164, (28, 28): -0.6633280830029267, (28, 29): -0.7024111379310345, (29, 29): -0.679672, (29, 28): -0.640849951724138, (29, 27): -0.602027903448276, (29, 26): -0.5626654586206897, (29, 25): -0.5232614448275862, (29, 24): -0.4783797620689655, (29, 23): -0.43258513448275865, (29, 22): -0.38549110344827575, (29, 21): -0.33804268965517237, (29, 20): -0.28824310344827586, (29, 19): -0.237503048275862, (29, 18): -0.18556102758620685, (29, 17): -0.13295124827586194, (29, 16): -0.07994773508306202, (29, 15): -0.02664892147842073, (29, 14): 0.026649875073303346, (29, 13): 0.07994865457211038, (29, 12): 0.13295218965517258, (29, 11): 0.1855620655172415, (29, 10): 0.2375040793103449, (29, 9): 0.28824394137931053, (29, 8): 0.33804338965517255, (29, 7): 0.3854918034482759, (29, 6): 0.4325858551724139, (29, 5): 0.47838057931034483, (29, 4): 0.5232623517241379, (29, 3): 0.5626664137931034, (29, 2): 0.6020289034482759, (29, 1): 0.6408509517241381, (29, 0): 0.679673}



if __name__ == "__main__":
    unittest.main()
